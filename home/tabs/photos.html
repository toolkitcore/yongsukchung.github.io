<div class="row">
  <div class="col-md-12 text-center mt-3">
    <h3>Random photos</h3>
  </div>
  <div class="row row-cols-1 row-cols-md-3" id="photo-category"></div>

  <a href="/photos" class="btn btn-success mt-5">Go to Photos</a>
</div>

<script>
  $(async function () {
    const categories = [
      {
        title: "Lab Sweet Memory",
        folder: "labSweetMemory"
      },
      {
        title: "2023 Summer Visit International Universtiy HCMVNU",
        folder: "visitHCMVNUSummer2023"
      },
      {
        title: "2023 Summer Visit Visayas State University",
        folder: "visitVisayasStateUniversitySummer2023"
      }
      ,
      {
        title: "2023 Spring Welcome The President of Visayas State University Philippines",
        folder: "welcomeThePresidentOfVisayasStateUniversityPhilippinesSpring2023"
      }
      ,
      {
        title: "2023 Spring Visit Germany",
        folder: "visitGermanySpring2023"
      }
      ,
      {
        title: "2023 Spring Meet Professors and Researchers in Vietnam",
        folder: "meetProfessorsAndResearchersInVietnamSpring2023"
      }
      ,
      {
        title: "2022 Welcome The President of University of Science HCMVNU",
        folder: "welcomeThePresidentOfUniversityOfScienceHCMVNU2022"
      }
      ,
      {
        title: "2022 Visit Saudi Arabia",
        folder: "visitSaudiArabia2022"
      }
      ,
      {
        title: "2022 Summer Relax",
        folder: "summerRelax2022"
      }
      ,
      {
        title: "2022 Fall Coffee with new Postdoc and PhD student",
        folder: "fallCoffeeWithNewPostdocAndPhDStudent2022"
      }
      ,
      {
        title: "2021 Working on the field",
        folder: "workingOnTheField2021"
      }
      ,
      {
        title: "2021 With PhD student",
        folder: "withPhDStudent2021"
      }
      ,
      {
        title: "2020 Researcher visit Phenomics Lab",
        folder: "researcherVisitPhenomicsLab2020"
      }
    ]
    const categoryDiv = $('#photo-category')
    const promises = categories.map(category => $.getJSON(`../photos/${category.folder}/data.json`))

    const dataArray = await Promise.all(promises)

      console.log(dataArray)

      dataArray.forEach((array, index) => array.forEach(item => item.folder = categories[index].folder))

    const images = dataArray.flat()

    images.sort((a, b) => 0.5 - Math.random()).filter((item, index) => index < 8).forEach((image, index) => {
      console.log(image)
      categoryDiv.append(`
              <div class="col-lg-3 col-md-4 col-6">
                  <a href="../../photos/${image.folder}" class="d-block mb-4 h-100">
                      <img class="img-fluid img-thumbnail border border-start-0 border-5" style="max-height: 20rem;width:auto;" src="${image.src}" alt="${image.title}">
                      <p>${image.title}</p>
                  </a>
              </div>
          `)
    })

  })
</script>